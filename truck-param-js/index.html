<html>
  <head>
    <script src="./bootstrap.js" type="module"></script>
    <style type="text/css">
      * {
        text-align: center;
        margin: 10px auto;
        background-color: #f8f9fb;
      }

      canvas {
        width: 50vw;
        height: 50vh;
      }
    </style>
  </head>

  <body>
    <canvas id="canvas"></canvas><br />
    <input type="range" min="0.01" max="1" step="0.1" /><br />
    <script>
      function defer(method) {
        if (window.TruckParam) {
          method();
        } else {
          setTimeout(function () {
            defer(method);
          }, 50);
        }
      }

      if (document.readyState !== "loading") {
        onLoad();
      } else {
        addEventListener("load", onLoad, false);
      }

      let app;

      function onLoad() {
        defer(function () {
          let c = document.getElementById("canvas");
          app = new window.TruckParam.App(c);

          document.querySelector("input").addEventListener("change", fileRead);
        });
      }

      function fileRead(e) {
        if (typeof e.target.value === "undefined") {
          console.warn("invalid input");
          return;
        }
        const solid = window.TruckParam.Truck.build_torus(0.5, e.target.value);
        let polygon = solid.to_polygon(0.01);
        app.draw(polygon);
      }
    </script>
  </body>
</html>
